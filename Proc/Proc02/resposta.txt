Procedure 02

OBS: Adicionei um parâmetro a mais na procedure para que a mesma devolva o Código da Sessão que está sendo atualizado os ingressos.

CREATE OR REPLACE PROCEDURE DEFINE_TOTAL_INGRESSOS(IN IN_COD_SESSAO INTEGER, IN IN_TOTAL_INGRESSOS INTEGER, INOUT N_SESSAO INTEGER)
AS
$$
BEGIN
	IF IN_TOTAL_INGRESSOS <= 0 THEN
		RAISE EXCEPTION 'TOTAL DE INGRESSOS NEGATIVOS OU IGUAL A ZERO';
	ELSE
		SELECT COD_SESSAO FROM SESSAO WHERE COD_SESSAO = IN_COD_SESSAO INTO N_SESSAO;
		UPDATE SESSAO SET TOTAL_INGRESSOS = IN_TOTAL_INGRESSOS WHERE COD_SESSAO = IN_COD_SESSAO;
	END IF;
END;
$$
LANGUAGE PLPGSQL;

DO $$
DECLARE
	TOT_SESSAO INTEGER;
BEGIN
	CALL DEFINE_TOTAL_INGRESSOS(5, 5, TOT_SESSAO);
	RAISE NOTICE 'TOTAL DE INGRESSOS NA SESSAO % COM SUCESSO.', TOT_SESSAO;
END;
$$