Função 05

Retorna as reservas de determinado cliente de determianda cidade

CREATE OR REPLACE FUNCTION RES_CLI_ESPE(C_CIDADE INTEGER, C_ESPETACULO INTEGER)
RETURNS INTEGER AS
$$
DECLARE
N_CLIENTE INTEGER;
BEGIN
	SELECT COUNT(*) FROM RESERVA AS R
	JOIN PEDIDO AS PD ON PD.COD_PEDIDO = R.COD_PEDIDO
	JOIN CLIENTE AS CL ON CL.COD_CLIENTE = PD.COD_CLIENTE
	WHERE CL.COD_CIDADE = C_CIDADE AND R.COD_ESPETACULO = C_ESPETACULO INTO N_CLIENTE;
	RETURN N_CLIENTE;
END;
$$
LANGUAGE PLPGSQL;

SELECT RES_CLI_ESPE(1, 1);