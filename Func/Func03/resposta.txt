CREATE OR REPLACE FUNCTION GET_PEDIDOS(COD_CLIENTE INTEGER)
RETURNS INTEGER AS
$$
DECLARE
	PEDIDO INTEGER;
BEGIN 
	SELECT INTO PEDIDO COUNT(COD_PEDIDO) FROM PEDIDO AS P 
	JOIN CLIENTE AS C ON P.COD_CLIENTE = C.COD_CLIENTE 
	JOIN CIDADE AS CI ON C.COD_CIDADE = CI.COD_CIDADE
	WHERE C.COD_CLIENTE = COD_CLIENTE;
	RETURN PEDIDO;
END;
$$
LANGUAGE PLPGSQL;
